**********************
Windows PowerShell transcript start
Start time: 20260116094613
Username: LALV1001128\Admin
RunAs User: LALV1001128\Admin
Configuration Name: 
Machine: LALV1001128 (Microsoft Windows NT 10.0.26100.0)
Host Application: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
Process ID: 13148
PSVersion: 5.1.26100.2161
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.26100.2161
BuildVersion: 10.0.26100.2161
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
Transcript started, output file is .\logs\day2\Spotify_Day2_Command_History.txt
PS C:\Users\Admin\Projects\spotify-data-pipeline> datetime
datetime : The term 'datetime' is not recognized as the name of a cmdlet, function, script file, or operable program. 
Check the spelling of the name, or if a path was included, verify that the path is correct and try again.
At line:1 char:1
+ datetime
+ ~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (datetime:String) [], CommandNotFoundException
    + FullyQualifiedErrorId : CommandNotFoundException
datetime : The term 'datetime' is not recognized as the name of a cmdlet, function, script file,
or operable program. Check the spelling of the name, or if a path was included, verify that the
path is correct and try again.
At line:1 char:1
+ datetime
+ ~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (datetime:String) [], CommandNotFoundException
    + FullyQualifiedErrorId : CommandNotFoundException

PS C:\Users\Admin\Projects\spotify-data-pipeline> date

Friday, January 16, 2026 9:47:02 AM


PS C:\Users\Admin\Projects\spotify-data-pipeline> ls logs


    Directory: C:\Users\Admin\Projects\spotify-data-pipeline\logs


Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
d-----         1/16/2026   9:46 AM                day2
-a----         1/14/2026  12:42 PM           1502 Spotify_PreDay2_Command_History.txt


PS C:\Users\Admin\Projects\spotify-data-pipeline> ls logs\faay2
ls : Cannot find path 'C:\Users\Admin\Projects\spotify-data-pipeline\logs\faay2' because it does not exist.
At line:1 char:1
+ ls logs\faay2
+ ~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (C:\Users\Admin\...line\logs\faay2:String) [Get-ChildItem], 
ItemNotFoundException
    + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Commands.GetChildItemCommand
ls : Cannot find path 'C:\Users\Admin\Projects\spotify-data-pipeline\logs\faay2' because it does not exist.
At line:1 char:1
+ ls logs\faay2
+ ~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (C:\Users\Admin\...line\logs\faay2:String) [Get-ChildItem], ItemNotFound
   Exception
    + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Commands.GetChildItemCommand

PS C:\Users\Admin\Projects\spotify-data-pipeline> ls logs\day2


    Directory: C:\Users\Admin\Projects\spotify-data-pipeline\logs\day2


Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
-a----         1/16/2026   9:46 AM              0 Spotify_Day2_Command_History.txt


PS C:\Users\Admin\Projects\spotify-data-pipeline> Start-Transcript -Path "C:\Users\Admin\Projects\spotify-data-pipeline\logs\day2\Spotify_Day2_Command_History.txt" -Append
Transcript started, output file is C:\Users\Admin\Projects\spotify-data-pipeline\logs\day2\Spotify_Day2_Command_History.txt
PS C:\Users\Admin\Projects\spotify-data-pipeline> New-Item -ItemType Directory -Force data\day2 | Out-Null
PS C:\Users\Admin\Projects\spotify-data-pipeline> New-Item -ItemType Directory -Force data\day2\input | Out-Null
PS C:\Users\Admin\Projects\spotify-data-pipeline> New-Item -ItemType Directory -Force data\day2\input\json | Out-Null
PS C:\Users\Admin\Projects\spotify-data-pipeline> New-Item -ItemType Directory -Force data\day2\input\csv  | Out-Null
PS C:\Users\Admin\Projects\spotify-data-pipeline> ls data\day2\input


    Directory: C:\Users\Admin\Projects\spotify-data-pipeline\data\day2\input


Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
d-----         1/16/2026   9:59 AM                csv
d-----         1/16/2026   9:59 AM                json


PS C:\Users\Admin\Projects\spotify-data-pipeline> @'
[
  {
    "track_id": "t_001",
    "track_name": "Neon Nights",
    "artist_name": "Ruby & The Data",
    "album_name": "Pipeline Dreams",
    "release_date": "2024-06-01",
    "duration_ms": 210000,
    "popularity": 55
  },
  {
    "track_id": "t_002",
    "track_name": "SQL Sunrise",
    "artist_name": "Window Functions",
    "album_name": "Analytics Vol. 1",
    "release_date": "2023-11-20",
    "duration_ms": 185000,
    "popularity": 62
  }
]
'@ | Set-Content -Encoding UTF8 data\day2\input\json\tracks.json
PS C:\Users\Admin\Projects\spotify-data-pipeline> Get-Content data\day2\input\json\tracks.json
[
  {
    "track_id": "t_001",
    "track_name": "Neon Nights",
    "artist_name": "Ruby & The Data",
    "album_name": "Pipeline Dreams",
    "release_date": "2024-06-01",
    "duration_ms": 210000,
    "popularity": 55
  },
  {
    "track_id": "t_002",
    "track_name": "SQL Sunrise",
    "artist_name": "Window Functions",
    "album_name": "Analytics Vol. 1",
    "release_date": "2023-11-20",
    "duration_ms": 185000,
    "popularity": 62
  }
]
PS C:\Users\Admin\Projects\spotify-data-pipeline> @"
track_id,track_name,artist_name,album_name,release_date,duration_ms,popularity
t_003,ETL Everyday,Stack Builders,Shipping Data,2022-09-10,199000,48
t_004,Commit & Push,Version Control,Git Groove,2021-03-15,175000,40
"@ | Set-Content -Encoding UTF8 data\day2\input\csv\tracks.csv
PS C:\Users\Admin\Projects\spotify-data-pipeline> Get-Content data\day2\input\csv\tracks.csv
track_id,track_name,artist_name,album_name,release_date,duration_ms,popularity
t_003,ETL Everyday,Stack Builders,Shipping Data,2022-09-10,199000,48
t_004,Commit & Push,Version Control,Git Groove,2021-03-15,175000,40
PS C:\Users\Admin\Projects\spotify-data-pipeline> ls


    Directory: C:\Users\Admin\Projects\spotify-data-pipeline


Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
d-----         1/16/2026   9:40 AM                -p
d-----         1/14/2026  11:22 AM                .venv
d-----          1/8/2026   1:04 PM                data
d-----         1/16/2026   9:40 AM                logs
d-----         1/14/2026  12:05 PM                src
d-----          1/7/2026   3:42 PM                venv
-a----          1/8/2026  12:51 PM            177 .env
-a----          1/8/2026  12:52 PM             11 .gitignore
-a----         1/16/2026   9:50 AM              0 cd
-a----          1/7/2026   4:56 PM            827 day0_setup_cmd_history.txt
-a----         1/14/2026  11:39 AM             48 requirements.txt


PS C:\Users\Admin\Projects\spotify-data-pipeline> ls src


    Directory: C:\Users\Admin\Projects\spotify-data-pipeline\src


Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
d-----         1/14/2026  12:15 PM                utils
-a----         1/14/2026  12:15 PM            375 main.py


PS C:\Users\Admin\Projects\spotify-data-pipeline> Get-Content .\src\main.py
import uuid
from dotenv import load_dotenv
from utils.mock_extract import extract_mock
from utils.db import insert_tracks

def main():
    load_dotenv()
    run_id = str(uuid.uuid4())
    rows = extract_mock(run_id=run_id)
    insert_tracks(rows)
    print(f"Loaded {len(rows)} rows into raw.tracks_mock (run_id={run_id})")

if __name__ == "__main__":
    main()
PS C:\Users\Admin\Projects\spotify-data-pipeline> Get-Content .\src\utils\db.py
import os
import psycopg2
from psycopg2.extras import execute_values

def get_conn():
    return psycopg2.connect(
        host=os.getenv("DB_HOST", "localhost"),
        port=int(os.getenv("DB_PORT", "5432")),
        dbname=os.getenv("DB_NAME"),
        user=os.getenv("DB_USER", "postgres"),
        password=os.getenv("DB_PASSWORD"),
    )

def insert_tracks(rows):
    cols = [
        "run_id", "extracted_at", "track_id", "track_name", "artist_name",
        "album_name", "release_date", "popularity", "duration_ms", "source"
    ]
    values = [[r.get(c) for c in cols] for r in rows]

    sql = f"INSERT INTO raw.tracks_mock ({','.join(cols)}) VALUES %s"

    with get_conn() as conn:
        with conn.cursor() as cur:
           execute_values(cur, sql, values)
        conn.commit()
PS C:\Users\Admin\Projects\spotify-data-pipeline> Get-Content .src\utils\mock_extract.py
Get-Content : Cannot find path 'C:\Users\Admin\Projects\spotify-data-pipeline\.src\utils\mock_extract.py' because it 
does not exist.
At line:1 char:1
+ Get-Content .src\utils\mock_extract.py
+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (C:\Users\Admin\...mock_extract.py:String) [Get-Content], 
ItemNotFoundException
    + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Commands.GetContentCommand
Get-Content : Cannot find path 'C:\Users\Admin\Projects\spotify-data-pipeline\.src\utils\mock_extract.py' because it
does not exist.
At line:1 char:1
+ Get-Content .src\utils\mock_extract.py
+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (C:\Users\Admin\...mock_extract.py:String) [Get-Content], ItemNotFoundEx
   ception
    + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Commands.GetContentCommand

PS C:\Users\Admin\Projects\spotify-data-pipeline> notepad .\src\utils\file_extract.py
PS C:\Users\Admin\Projects\spotify-data-pipeline> notepad .\src\main.py
PS C:\Users\Admin\Projects\spotify-data-pipeline> python .\src\main.py
Traceback (most recent call last):
  File "C:\Users\Admin\Projects\spotify-data-pipeline\src\main.py", line 2, in <module>
    from dotenv import load_dotenv
ModuleNotFoundError: No module named 'dotenv'
PS C:\Users\Admin\Projects\spotify-data-pipeline> notepad .\src\main.py
PS C:\Users\Admin\Projects\spotify-data-pipeline> .\.venv\Scripts\activate.ps1
.\.venv\Scripts\activate.ps1 : File C:\Users\Admin\Projects\spotify-data-pipeline\.venv\Scripts\Activate.ps1 cannot be 
loaded because running scripts is disabled on this system. For more information, see about_Execution_Policies at 
https:/go.microsoft.com/fwlink/?LinkID=135170.
At line:1 char:1
+ .\.venv\Scripts\activate.ps1
+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : SecurityError: (:) [], PSSecurityException
    + FullyQualifiedErrorId : UnauthorizedAccess
.\.venv\Scripts\activate.ps1 : File C:\Users\Admin\Projects\spotify-data-pipeline\.venv\Scripts\Activate.ps1 cannot be
loaded because running scripts is disabled on this system. For more information, see about_Execution_Policies at
https:/go.microsoft.com/fwlink/?LinkID=135170.
At line:1 char:1
+ .\.venv\Scripts\activate.ps1
+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : SecurityError: (:) [], PSSecurityException
    + FullyQualifiedErrorId : UnauthorizedAccess
PS C:\Users\Admin\Projects\spotify-data-pipeline> Set-ExecutionPolicy -Scope CurrentUser -ExecutionPolicy RemoteSigned
Execution Policy Change
The execution policy helps protect you from scripts that you do not trust. Changing the execution policy might expose you to the security risks described in the about_Execution_Policies help topic at https:/go.microsoft.com/fwlink/?LinkID=135170. Do you want to change the execution policy?
&Yes  Yes to &All  &No  No to A&ll  &Suspend
Y
PS C:\Users\Admin\Projects\spotify-data-pipeline> .\.venv\Scripts\activate.ps1
PS C:\Users\Admin\Projects\spotify-data-pipeline>
PS C:\Users\Admin\Projects\spotify-data-pipeline>
PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) pip install python-dotenv
>> TerminatingError(): "Program 'pip.exe' failed to run: Access is deniedAt line:1 char:1
+ pip install python-dotenv
+ ~~~~~~~~~~~~~~~~~~~~~~~~~."
Program 'pip.exe' failed to run: Access is deniedAt line:1 char:1
+ pip install python-dotenv
+ ~~~~~~~~~~~~~~~~~~~~~~~~~.
At line:1 char:1
+ pip install python-dotenv
+ ~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ResourceUnavailable: (:) [], ApplicationFailedException
    + FullyQualifiedErrorId : NativeCommandFailed
Program 'pip.exe' failed to run: Access is deniedAt line:1 char:1
+ pip install python-dotenv
+ ~~~~~~~~~~~~~~~~~~~~~~~~~.
At line:1 char:1
+ pip install python-dotenv
+ ~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ResourceUnavailable: (:) [], ApplicationFailedException
    + FullyQualifiedErrorId : NativeCommandFailed

PS C:\Users\Admin\Projects\spotify-data-pipeline>
PS C:\Users\Admin\Projects\spotify-data-pipeline>
PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) python -m pip install --upgrade pip
Requirement already satisfied: pip in c:\users\admin\projects\spotify-data-pipeline\.venv\lib\site-packages (25.3)
PS C:\Users\Admin\Projects\spotify-data-pipeline>
PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) python -m pip install python-dotenv
Requirement already satisfied: python-dotenv in c:\users\admin\projects\spotify-data-pipeline\.venv\lib\site-packages (1
.2.1)
PS C:\Users\Admin\Projects\spotify-data-pipeline>
PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) python .\src\main.py
Traceback (most recent call last):
  File "C:\Users\Admin\Projects\spotify-data-pipeline\src\main.py", line 14, in <module>
    main()
    ~~~~^^
  File "C:\Users\Admin\Projects\spotify-data-pipeline\src\main.py", line 9, in main
    rows = extract_from_files(run_id=run_id)
  File "C:\Users\Admin\Projects\spotify-data-pipeline\src\utils\file_extract.py", line 52, in extract_from_files
    data = json.load(f)
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python313\Lib\json\__init__.py", line 293, in load
    return loads(fp.read(),
        cls=cls, object_hook=object_hook,
        parse_float=parse_float, parse_int=parse_int,
        parse_constant=parse_constant, object_pairs_hook=object_pairs_hook, **kw)
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python313\Lib\json\__init__.py", line 335, in loads
    raise JSONDecodeError("Unexpected UTF-8 BOM (decode using utf-8-sig)",
                          s, 0)
json.decoder.JSONDecodeError: Unexpected UTF-8 BOM (decode using utf-8-sig): line 1 column 1 (char 0)
PS C:\Users\Admin\Projects\spotify-data-pipeline>
PS C:\Users\Admin\Projects\spotify-data-pipeline>
PS C:\Users\Admin\Projects\spotify-data-pipeline>
PS C:\Users\Admin\Projects\spotify-data-pipeline>
PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) .\.venv\Scripts\python.exe -m pip install --upgrade pip
Requirement already satisfied: pip in c:\users\admin\projects\spotify-data-pipeline\.venv\lib\site-packages (25.3)
PS C:\Users\Admin\Projects\spotify-data-pipeline>
PS C:\Users\Admin\Projects\spotify-data-pipeline>
PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) .\.venv\Scripts\python.exe -m pip install python-dotenv
Requirement already satisfied: python-dotenv in c:\users\admin\projects\spotify-data-pipeline\.venv\lib\site-packages (1
.2.1)
PS C:\Users\Admin\Projects\spotify-data-pipeline>
PS C:\Users\Admin\Projects\spotify-data-pipeline>
PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) python .\src\main.py
Traceback (most recent call last):
  File "C:\Users\Admin\Projects\spotify-data-pipeline\src\main.py", line 14, in <module>
    main()
    ~~~~^^
  File "C:\Users\Admin\Projects\spotify-data-pipeline\src\main.py", line 9, in main
    rows = extract_from_files(run_id=run_id)
  File "C:\Users\Admin\Projects\spotify-data-pipeline\src\utils\file_extract.py", line 52, in extract_from_files
    data = json.load(f)
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python313\Lib\json\__init__.py", line 293, in load
    return loads(fp.read(),
        cls=cls, object_hook=object_hook,
        parse_float=parse_float, parse_int=parse_int,
        parse_constant=parse_constant, object_pairs_hook=object_pairs_hook, **kw)
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python313\Lib\json\__init__.py", line 335, in loads
    raise JSONDecodeError("Unexpected UTF-8 BOM (decode using utf-8-sig)",
                          s, 0)
json.decoder.JSONDecodeError: Unexpected UTF-8 BOM (decode using utf-8-sig): line 1 column 1 (char 0)
PS C:\Users\Admin\Projects\spotify-data-pipeline>
PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) notepad .\src\utils\file_extract.py
PS C:\Users\Admin\Projects\spotify-data-pipeline>
PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) python .\src\main.py
Loaded 4 rows into raw.tracks_mock (run_id=4a0ea519-d75e-4f4e-8931-4c72282f8dcc)
PS C:\Users\Admin\Projects\spotify-data-pipeline>
PS C:\Users\Admin\Projects\spotify-data-pipeline>
PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) psql -p 5432 -U postgres -d postgres -c "SELECT source, COUNT(*) FROM raw.tracks_mock GROUP BY source ORDER BY source;"
psql : The term 'psql' is not recognized as the name of a cmdlet, function, script file, or operable program. Check the 
spelling of the name, or if a path was included, verify that the path is correct and try again.
At line:1 char:1
+ psql -p 5432 -U postgres -d postgres -c "SELECT source, COUNT(*) FROM ...
+ ~~~~
    + CategoryInfo          : ObjectNotFound: (psql:String) [], CommandNotFoundException
    + FullyQualifiedErrorId : CommandNotFoundException
psql : The term 'psql' is not recognized as the name of a cmdlet, function, script file, or operable program. Check
the spelling of the name, or if a path was included, verify that the path is correct and try again.
At line:1 char:1
+ psql -p 5432 -U postgres -d postgres -c "SELECT source, COUNT(*) FROM ...
+ ~~~~
    + CategoryInfo          : ObjectNotFound: (psql:String) [], CommandNotFoundException
    + FullyQualifiedErrorId : CommandNotFoundException

PS C:\Users\Admin\Projects\spotify-data-pipeline>
PS C:\Users\Admin\Projects\spotify-data-pipeline>
PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) notepad .\src\qa_day2_counts.py
PS C:\Users\Admin\Projects\spotify-data-pipeline>
PS C:\Users\Admin\Projects\spotify-data-pipeline>
PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) python .\src\qa_day2_counts.py
Traceback (most recent call last):
  File "C:\Users\Admin\Projects\spotify-data-pipeline\src\qa_day2_counts.py", line 21, in <module>
    main()
    ~~~~^^
  File "C:\Users\Admin\Projects\spotify-data-pipeline\src\qa_day2_counts.py", line 11, in main
    with get_conn() as conn:
         ~~~~~~~~^^
  File "C:\Users\Admin\Projects\spotify-data-pipeline\src\utils\db.py", line 6, in get_conn
    return psycopg2.connect(
           ~~~~~~~~~~~~~~~~^
        host=os.getenv("DB_HOST", "localhost"),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
        password=os.getenv("DB_PASSWORD"),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Admin\Projects\spotify-data-pipeline\.venv\Lib\site-packages\psycopg2\__init__.py", line 135, in connec
t
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
psycopg2.OperationalError: connection to server at "localhost" (::1), port 5432 failed: fe_sendauth: no password supplie
d
PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) notepad .\src\qa_day2_counts.py
PS C:\Users\Admin\Projects\spotify-data-pipeline>
PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) python .\src\qa_day2_counts.py
  File "C:\Users\Admin\Projects\spotify-data-pipeline\src\qa_day2_counts.py", line 1
    from dotenv import load dotenv
                            ^^^^^^
SyntaxError: invalid syntax
PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) notepad .\src\main.py
PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) python .\src\main.py
Loaded 4 rows into raw.tracks_mock (run_id=84eebafa-613b-4128-9e4a-e74bd3e1662b)
Counts by source:
csv: 4
json: 4
mock: 2
PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) date

Friday, January 16, 2026 10:52:39 AM


PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) New-Item -ItemType Directory -Force .\src\migrations | Out-Null
PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) notepad .\src\migrations\day2_add_unique.py
PS C:\Users\Admin\Projects\spotify-data-pipeline>
PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) python .\src\migrations\day2_add_unique.py
Traceback (most recent call last):
  File "C:\Users\Admin\Projects\spotify-data-pipeline\src\migrations\day2_add_unique.py", line 2, in <module>
    from utils.db import get_conn
ModuleNotFoundError: No module named 'utils'
PS C:\Users\Admin\Projects\spotify-data-pipeline>
PS C:\Users\Admin\Projects\spotify-data-pipeline>
PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) New-Item -ItemType File -Force src\__init__.py | Out-Null
PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) New-Item -ItemType File -Force src\utils\__init__.py | Out-Null
PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) New-Item -ItemType File -Force src\migrations\__init__.py | Out-Null
PS C:\Users\Admin\Projects\spotify-data-pipeline>
PS C:\Users\Admin\Projects\spotify-data-pipeline>
PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) python -m src.migrations.day2_add_unique
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "C:\Users\Admin\Projects\spotify-data-pipeline\src\migrations\day2_add_unique.py", line 2, in <module>
    from utils.db import get_conn
ModuleNotFoundError: No module named 'utils'
PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) notepad .\src\migrations\day2_add_unique.py
PS C:\Users\Admin\Projects\spotify-data-pipeline>
PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) python -m src.migrations.day2_add_unique
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "C:\Users\Admin\Projects\spotify-data-pipeline\src\migrations\day2_add_unique.py", line 18, in <module>
    main()
    ~~~~^^
  File "C:\Users\Admin\Projects\spotify-data-pipeline\src\migrations\day2_add_unique.py", line 13, in main
    cur.execute(DDL)
    ~~~~~~~~~~~^^^^^
psycopg2.errors.UniqueViolation: could not create unique index "tracks_mock_track_id_source_uk"
DETAIL:  Key (track_id, source)=(t_002, json) is duplicated.
PS C:\Users\Admin\Projects\spotify-data-pipeline>
PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) notepad .\src\migrations\day2_dedupe_tracks_mock.py
PS C:\Users\Admin\Projects\spotify-data-pipeline>
PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) python -m src.migrations.day2_dedupe_tracks_mock
OK: deduped raw.tracks_mock (deleted 2 duplicate rows)
PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) python -m src.migrations.day2_add_unique
OK: added UNIQUE(track_id, source) on raw.tracks_mock
PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) notepad .\src\utils\db.py
PS C:\Users\Admin\Projects\spotify-data-pipeline>
PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) python .\src\main.py
Loaded 4 rows into raw.tracks_mock (run_id=52dafc04-808e-4bd3-8fb0-471eea0fd29d)
Counts by source:
csv: 6
json: 2
mock: 2
PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) Stop-Transcript
Transcript stopped, output file is C:\Users\Admin\Projects\spotify-data-pipeline\logs\day2\Spotify_Day2_Command_History.txt
PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) ls .\logs\day2


    Directory: C:\Users\Admin\Projects\spotify-data-pipeline\logs\day2


Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
-a----         1/16/2026  11:05 AM          23990 Spotify_Day2_Command_History.txt


PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) python .\src\main.py
Loaded 4 rows into raw.tracks_mock (run_id=0d6f79e8-b33d-4d17-a4b4-9c2880231c94)
Counts by source:
csv: 8
json: 2
mock: 2
PS C:\Users\Admin\Projects\spotify-data-pipeline>
PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) pwd

Path
----
C:\Users\Admin\Projects\spotify-data-pipeline


PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) ls


    Directory: C:\Users\Admin\Projects\spotify-data-pipeline


Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
d-----         1/16/2026   9:40 AM                -p
d-----         1/14/2026  11:22 AM                .venv
d-----         1/16/2026   9:59 AM                data
d-----         1/16/2026   9:40 AM                logs
d-----         1/16/2026  10:56 AM                src
d-----          1/7/2026   3:42 PM                venv
-a----          1/8/2026  12:51 PM            177 .env
-a----          1/8/2026  12:52 PM             11 .gitignore
-a----         1/16/2026   9:50 AM              0 cd
-a----          1/7/2026   4:56 PM            827 day0_setup_cmd_history.txt
-a----         1/14/2026  11:39 AM             48 requirements.txt


PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) date

Tuesday, January 20, 2026 9:30:28 AM


PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) mkdir logs\day3


    Directory: C:\Users\Admin\Projects\spotify-data-pipeline\logs


Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
d-----         1/20/2026   9:30 AM                day3


PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) Start-Transcript -Path logs\day3\Spotify_Day3_Traanscript.txt -Append
Transcript started, output file is logs\day3\Spotify_Day3_Traanscript.txt
PS C:\Users\Admin\Projects\spotify-data-pipeline>
PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) date

Tuesday, January 20, 2026 9:32:26 AM


PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) pwd

Path
----
C:\Users\Admin\Projects\spotify-data-pipeline


PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) ls


    Directory: C:\Users\Admin\Projects\spotify-data-pipeline


Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
d-----         1/16/2026   9:40 AM                -p
d-----         1/14/2026  11:22 AM                .venv
d-----         1/16/2026   9:59 AM                data
d-----         1/16/2026   9:40 AM                logs
d-----         1/16/2026  10:56 AM                src
d-----          1/7/2026   3:42 PM                venv
-a----          1/8/2026  12:51 PM            177 .env
-a----          1/8/2026  12:52 PM             11 .gitignore
-a----         1/16/2026   9:50 AM              0 cd
-a----          1/7/2026   4:56 PM            827 day0_setup_cmd_history.txt
-a----         1/14/2026  11:39 AM             48 requirements.txt


PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) netstat -an | findstr 5432
  TCP    0.0.0.0:5432           0.0.0.0:0              LISTENING
  TCP    [::]:5432              [::]:0                 LISTENING
  TCP    [::1]:5432             [::1]:50483            ESTABLISHED
  TCP    [::1]:5432             [::1]:50488            ESTABLISHED
  TCP    [::1]:5432             [::1]:50506            ESTABLISHED
  TCP    [::1]:50483            [::1]:5432             ESTABLISHED
  TCP    [::1]:50488            [::1]:5432             ESTABLISHED
  TCP    [::1]:50506            [::1]:5432             ESTABLISHED
PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) psql -h locaaalhost -p 5432 -U postgres
psql : The term 'psql' is not recognized as the name of a cmdlet, function, script file, or operable program. Check the 
spelling of the name, or if a path was included, verify that the path is correct and try again.
At line:1 char:1
+ psql -h locaaalhost -p 5432 -U postgres
+ ~~~~
    + CategoryInfo          : ObjectNotFound: (psql:String) [], CommandNotFoundException
    + FullyQualifiedErrorId : CommandNotFoundException
psql : The term 'psql' is not recognized as the name of a cmdlet, function, script file, or operable program. Check
the spelling of the name, or if a path was included, verify that the path is correct and try again.
At line:1 char:1
+ psql -h locaaalhost -p 5432 -U postgres
+ ~~~~
    + CategoryInfo          : ObjectNotFound: (psql:String) [], CommandNotFoundException
    + FullyQualifiedErrorId : CommandNotFoundException

PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) psql -h localhost -p 5432 -U postgres
psql : The term 'psql' is not recognized as the name of a cmdlet, function, script file, or operable program. Check the 
spelling of the name, or if a path was included, verify that the path is correct and try again.
At line:1 char:1
+ psql -h localhost -p 5432 -U postgres
+ ~~~~
    + CategoryInfo          : ObjectNotFound: (psql:String) [], CommandNotFoundException
    + FullyQualifiedErrorId : CommandNotFoundException
psql : The term 'psql' is not recognized as the name of a cmdlet, function, script file, or operable program. Check
the spelling of the name, or if a path was included, verify that the path is correct and try again.
At line:1 char:1
+ psql -h localhost -p 5432 -U postgres
+ ~~~~
    + CategoryInfo          : ObjectNotFound: (psql:String) [], CommandNotFoundException
    + FullyQualifiedErrorId : CommandNotFoundException

PS C:\Users\Admin\Projects\spotify-data-pipeline>
PS C:\Users\Admin\Projects\spotify-data-pipeline>
PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) Get-Service | Where-Object {$_.Name -like "*postgres*" }

Status   Name               DisplayName
------   ----               -----------
Running  postgresql-x64-17  postgresql-x64-17 - PostgreSQL Serv...


PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) netstat -an | finstr 5432
finstr : The term 'finstr' is not recognized as the name of a cmdlet, function, script file, or operable program. Check 
the spelling of the name, or if a path was included, verify that the path is correct and try again.
At line:1 char:15
+ netstat -an | finstr 5432
+               ~~~~~~
    + CategoryInfo          : ObjectNotFound: (finstr:String) [], CommandNotFoundException
    + FullyQualifiedErrorId : CommandNotFoundException
finstr : The term 'finstr' is not recognized as the name of a cmdlet, function, script file, or operable program.
Check the spelling of the name, or if a path was included, verify that the path is correct and try again.
At line:1 char:15
+ netstat -an | finstr 5432
+               ~~~~~~
    + CategoryInfo          : ObjectNotFound: (finstr:String) [], CommandNotFoundException
    + FullyQualifiedErrorId : CommandNotFoundException

PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) netstat -an | findstr 5432
  TCP    0.0.0.0:5432           0.0.0.0:0              LISTENING
  TCP    [::]:5432              [::]:0                 LISTENING
  TCP    [::1]:5432             [::1]:50483            ESTABLISHED
  TCP    [::1]:5432             [::1]:50488            ESTABLISHED
  TCP    [::1]:5432             [::1]:50506            ESTABLISHED
  TCP    [::1]:50483            [::1]:5432             ESTABLISHED
  TCP    [::1]:50488            [::1]:5432             ESTABLISHED
  TCP    [::1]:50506            [::1]:5432             ESTABLISHED
PS C:\Users\Admin\Projects\spotify-data-pipeline>
PS C:\Users\Admin\Projects\spotify-data-pipeline>
PS C:\Users\Admin\Projects\spotify-data-pipeline>
PS C:\Users\Admin\Projects\spotify-data-pipeline>
PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) date

Tuesday, January 20, 2026 9:41:17 AM


PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) ls


    Directory: C:\Users\Admin\Projects\spotify-data-pipeline


Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
d-----         1/16/2026   9:40 AM                -p
d-----         1/14/2026  11:22 AM                .venv
d-----         1/16/2026   9:59 AM                data
d-----         1/16/2026   9:40 AM                logs
d-----         1/16/2026  10:56 AM                src
d-----          1/7/2026   3:42 PM                venv
-a----          1/8/2026  12:51 PM            177 .env
-a----          1/8/2026  12:52 PM             11 .gitignore
-a----         1/16/2026   9:50 AM              0 cd
-a----          1/7/2026   4:56 PM            827 day0_setup_cmd_history.txt
-a----         1/14/2026  11:39 AM             48 requirements.txt


PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) ls src


    Directory: C:\Users\Admin\Projects\spotify-data-pipeline\src


Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
d-----         1/16/2026  11:01 AM                migrations
d-----         1/16/2026  10:55 AM                utils
d-----         1/16/2026  10:56 AM                __pycache__
-a----         1/16/2026  10:49 AM            845 main.py
-a----         1/16/2026  10:46 AM            455 qa_day2_counts.py
-a----         1/16/2026  10:55 AM              0 __init__.py


PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) ls\src\migrations
ls\src\migrations : The module 'ls' could not be loaded. For more information, run 'Import-Module ls'.
At line:1 char:1
+ ls\src\migrations
+ ~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (ls\src\migrations:String) [], CommandNotFoundException
    + FullyQualifiedErrorId : CouldNotAutoLoadModule
ls\src\migrations : The module 'ls' could not be loaded. For more information, run 'Import-Module ls'.
At line:1 char:1
+ ls\src\migrations
+ ~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (ls\src\migrations:String) [], CommandNotFoundException
    + FullyQualifiedErrorId : CouldNotAutoLoadModule

PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) ls \src\migrations
ls : Cannot find path 'C:\src\migrations' because it does not exist.
At line:1 char:1
+ ls \src\migrations
+ ~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (C:\src\migrations:String) [Get-ChildItem], ItemNotFoundException
    + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Commands.GetChildItemCommand
ls : Cannot find path 'C:\src\migrations' because it does not exist.
At line:1 char:1
+ ls \src\migrations
+ ~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (C:\src\migrations:String) [Get-ChildItem], ItemNotFoundException
    + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Commands.GetChildItemCommand

PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) ls src


    Directory: C:\Users\Admin\Projects\spotify-data-pipeline\src


Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
d-----         1/16/2026  11:01 AM                migrations
d-----         1/16/2026  10:55 AM                utils
d-----         1/16/2026  10:56 AM                __pycache__
-a----         1/16/2026  10:49 AM            845 main.py
-a----         1/16/2026  10:46 AM            455 qa_day2_counts.py
-a----         1/16/2026  10:55 AM              0 __init__.py


PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) ls src\migrations


    Directory: C:\Users\Admin\Projects\spotify-data-pipeline\src\migrations


Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
d-----         1/16/2026  11:02 AM                __pycache__
-a----         1/16/2026  10:58 AM            452 day2_add_unique.py
-a----         1/16/2026  11:01 AM            550 day2_dedupe_tracks_mock.py
-a----         1/16/2026  10:55 AM              0 __init__.py


PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) ls src\migrations


    Directory: C:\Users\Admin\Projects\spotify-data-pipeline\src\migrations


Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
d-----         1/16/2026  11:02 AM                __pycache__
-a----         1/16/2026  10:58 AM            452 day2_add_unique.py
-a----         1/16/2026  11:01 AM            550 day2_dedupe_tracks_mock.py
-a----         1/16/2026  10:55 AM              0 __init__.py


PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) ls \src\migrations
ls : Cannot find path 'C:\src\migrations' because it does not exist.
At line:1 char:1
+ ls \src\migrations
+ ~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (C:\src\migrations:String) [Get-ChildItem], ItemNotFoundException
    + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Commands.GetChildItemCommand
ls : Cannot find path 'C:\src\migrations' because it does not exist.
At line:1 char:1
+ ls \src\migrations
+ ~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (C:\src\migrations:String) [Get-ChildItem], ItemNotFoundException
    + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Commands.GetChildItemCommand

PS C:\Users\Admin\Projects\spotify-data-pipeline>
PS C:\Users\Admin\Projects\spotify-data-pipeline>
PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) date

Tuesday, January 20, 2026 9:59:22 AM


PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) type .env
SPOTIFY_CLIENT_ID=
SPOTIFY_CLIENT_SECRET=

# Postgres (local dev)
DB_NAME=spotify_analytics
DB_USER=postgres
DB_PASSWORD=postgres_dev_2026
DB_HOST=localhost
DB_PORT=5432
PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) Get-ChildItem src\utils -Filter *.py | Select-Object Name

Name
----
db.py
file_extract.py
mock_extract.py
__init__.py


PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) Select-String -Path src\utils\*.py -Pattern 
>> TerminatingError(Select-String): "Missing an argument for parameter 'Pattern'. Specify a parameter of type 'System.String[]' and try again."
Select-String : Missing an argument for parameter 'Pattern'. Specify a parameter of type 'System.String[]' and try 
again.
At line:1 char:36
+ Select-String -Path src\utils\*.py -Pattern
+                                    ~~~~~~~~
    + CategoryInfo          : InvalidArgument: (:) [Select-String], ParameterBindingException
    + FullyQualifiedErrorId : MissingArgument,Microsoft.PowerShell.Commands.SelectStringCommand
Select-String : Missing an argument for parameter 'Pattern'. Specify a parameter of type 'System.String[]' and try
again.
At line:1 char:36
+ Select-String -Path src\utils\*.py -Pattern
+                                    ~~~~~~~~
    + CategoryInfo          : InvalidArgument: (:) [Select-String], ParameterBindingException
    + FullyQualifiedErrorId : MissingArgument,Microsoft.PowerShell.Commands.SelectStringCommand

PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) Select-String -Path src\utils\*.py -Pattern 'create_engine|sqlalchemy|psycopg2|DATABASE_URL|postgres'

src\utils\db.py:2:import psycopg2
src\utils\db.py:3:from psycopg2.extras import execute_values
src\utils\db.py:6:    return psycopg2.connect(
src\utils\db.py:10:        user=os.getenv("DB_USER", "postgres"),


PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) date

Tuesday, January 20, 2026 10:05:28 AM


PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) type src\utils\*.py
import os
import psycopg2
from psycopg2.extras import execute_values

def get_conn():
    return psycopg2.connect(
        host=os.getenv("DB_HOST", "localhost"),
        port=int(os.getenv("DB_PORT", "5432")),
        dbname=os.getenv("DB_NAME"),
        user=os.getenv("DB_USER", "postgres"),
        password=os.getenv("DB_PASSWORD"),
    )

def insert_tracks(rows):
    cols = [
        "run_id", "extracted_at", "track_id", "track_name", "artist_name",
        "album_name", "release_date", "popularity", "duration_ms", "source"
    ]
    values = [[r.get(c) for c in cols] for r in rows]

    sql = f"""
          INSERT INTO raw.tracks_mock ({','.join(cols)})
          VALUES %s
          ON CONFLICT (track_id, source) DO NOTHING
          """


    with get_conn() as conn:
        with conn.cursor() as cur:
           execute_values(cur, sql, values)
        conn.commit()
import csv
import json
import os
from datetime import datetime, timezone
from typing import Dict, List, Any


def _utc_now_iso() -> str:
    # Example: 2026-01-16T18:05:12Z
    return datetime.now(timezone.utc).replace(microsecond=0).isoformat().replace("+00:00", "Z")


def _normalize_track(row: Dict[str, Any], run_id: str, source: str) -> Dict[str, Any]:
    """
    Convert an input row (from JSON/CSV) into the dict format expected by utils.db.insert_tracks().
    """
    # Defensive parsing helpers
    def to_int(v):
        if v is None or v == "":
            return None
        try:
            return int(v)
        except Exception:
            return None

    return {
        "run_id": run_id,
        "extracted_at": _utc_now_iso(),
        "track_id": row.get("track_id"),
        "track_name": row.get("track_name"),
        "artist_name": row.get("artist_name"),
        "album_name": row.get("album_name"),
        "release_date": row.get("release_date"),
        "popularity": to_int(row.get("popularity")),
        "duration_ms": to_int(row.get("duration_ms")),
        "source": source,
    }


def extract_from_files(
    run_id: str,
    json_path: str = os.path.join("data", "day2", "input", "json", "tracks.json"),
    csv_path: str = os.path.join("data", "day2", "input", "csv", "tracks.csv"),
) -> List[Dict[str, Any]]:
    """
    Reads Day 2 JSON + CSV and returns a single list of normalized track rows.
    """
    rows: List[Dict[str, Any]] = []

    # --- JSON ---
    with open(json_path, "r", encoding="utf-8-sig") as f:
        data = json.load(f)
        if not isinstance(data, list):
            raise ValueError(f"JSON input must be a list of objects. Got: {type(data)}")
        for obj in data:
            if not isinstance(obj, dict):
                continue
            rows.append(_normalize_track(obj, run_id=run_id, source="json"))

    # --- CSV ---
    with open(csv_path, "r", encoding="utf-8", newline="") as f:
        reader = csv.DictReader(f)
        for obj in reader:
            rows.append(_normalize_track(obj, run_id=run_id, source="csv"))

    return rows
from datetime import datetime, date

def extract_mock(run_id: str):
    extracted_at = datetime.utcnow()
    return [
        {
            "run_id": run_id,
            "extracted_at": extracted_at,
            "track_id": "mock_001",
            "track_name": "Blinding Lights",
            "artist_name": "The Weeknd",
            "album_name": "After Hours",
            "release_date": date(2019, 11, 29),
            "popularity": 95,
            "duration_ms": 200040,
            "source": "mock",
        },
        {
            "run_id": run_id,
            "extracted_at": extracted_at,
            "track_id": "mock_002",
            "track_name": "bad guy",
            "artist_name": "Billie Eilish",
            "album_name": "WHEN WE ALL FALL ASLEEP, WHERE DO WE GO?",
            "release_date": date(2019, 3, 29),
            "popularity": 90,
            "duration_ms": 194088,
            "source": "mock",
        },
    ]
PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) daate
daate : The term 'daate' is not recognized as the name of a cmdlet, function, script file, or operable program. Check 
the spelling of the name, or if a path was included, verify that the path is correct and try again.
At line:1 char:1
+ daate
+ ~~~~~
    + CategoryInfo          : ObjectNotFound: (daate:String) [], CommandNotFoundException
    + FullyQualifiedErrorId : CommandNotFoundException
daate : The term 'daate' is not recognized as the name of a cmdlet, function, script file, or operable program. Check the spelling of the name, or if a path
was included, verify that the path is correct and try again.
At line:1 char:1
+ daate
+ ~~~~~
    + CategoryInfo          : ObjectNotFound: (daate:String) [], CommandNotFoundException
    + FullyQualifiedErrorId : CommandNotFoundException

PS C:\Users\Admin\Projects\spotify-data-pipeline>
PS C:\Users\Admin\Projects\spotify-data-pipeline>
PS C:\Users\Admin\Projects\spotify-data-pipeline>
PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) date

Tuesday, January 20, 2026 10:10:48 AM


PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) Get-ChildItem src\utils -Filter *.py | Select-Object Name

Name
----
db.py
file_extract.py
mock_extract.py
__init__.py


PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) notepad src\migrations\day3_create_clean_tracks.py
PS C:\Users\Admin\Projects\spotify-data-pipeline>
PS C:\Users\Admin\Projects\spotify-data-pipeline>
PS C:\Users\Admin\Projects\spotify-data-pipeline>
PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) python src\migrations\day3_create_clean_tracks.py
Traceback (most recent call last):
  File "C:\Users\Admin\Projects\spotify-data-pipeline\src\migrations\day3_create_clean_tracks.py", line 16, in <module>
    from src.utils.db import get_conn  # adjust if your file name differs
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ModuleNotFoundError: No module named 'src'
PS C:\Users\Admin\Projects\spotify-data-pipeline>
PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) notepad src\migrations\day3_create_clean_tracks.py
PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) notepad src\migrations\day3_create_clean_tracks.py
PS C:\Users\Admin\Projects\spotify-data-pipeline>
PS C:\Users\Admin\Projects\spotify-data-pipeline>
PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) python src\migrations\day3_create_clean_tracks.py
Traceback (most recent call last):
  File "C:\Users\Admin\Projects\spotify-data-pipeline\src\migrations\day3_create_clean_tracks.py", line 114, in <module>
    run()
    ~~~^^
  File "C:\Users\Admin\Projects\spotify-data-pipeline\src\migrations\day3_create_clean_tracks.py", line 108, in run
    with get_conn() as conn:
         ~~~~~~~~^^
  File "C:\Users\Admin\Projects\spotify-data-pipeline\src\utils\db.py", line 6, in get_conn
    return psycopg2.connect(
           ~~~~~~~~~~~~~~~~^
        host=os.getenv("DB_HOST", "localhost"),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
        password=os.getenv("DB_PASSWORD"),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Admin\Projects\spotify-data-pipeline\.venv\Lib\site-packages\psycopg2\__init__.py", line 135, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
psycopg2.OperationalError: connection to server at "localhost" (::1), port 5432 failed: fe_sendauth: no password supplied
PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) notepad .env
PS C:\Users\Admin\Projects\spotify-data-pipeline>
PS C:\Users\Admin\Projects\spotify-data-pipeline>
PS C:\Users\Admin\Projects\spotify-data-pipeline>
(.venv) Stop-Transcript
Transcript stopped, output file is C:\Users\Admin\Projects\spotify-data-pipeline\logs\day3\Spotify_Day3_Traanscript.txt
PS C:\Users\Admin\Projects\spotify-data-pipeline>
PS C:\Users\Admin\Projects\spotify-data-pipeline>
PS C:\Users\Admin\Projects\spotify-data-pipeline>
